<p id="notice"><%= notice %></p>

<h1 class="my-5 text-center font-weight-bolder">Approval Penjualan Barang</h1>

<% if current_user.roles.any? { |r| r.name == 'superadmin' || r.name == 'Staff Gudang' || r.name == 'Kepala Gudang' || r.name == 'Admin Persediaan' || r.name == 'Kepala Persediaan' } %>
<div class="row mx-0 px-5">
  <div class="table-responsive">
    <table class="table table-bordered" id="dataTable">
      <thead class="bg-primary">
      <tr class="text-center">
        <th>Catatan</th>
        <th>PIC</th>
        <th>Status Approval</th>
        <th>Nomor Penjualan</th>
        <th>Aksi</th>
      </tr>
      </thead>

      <tbody>
      <% @sale_histories.each do |sale_history| %>

        <% status = Status.find_by(id: sale_history.status) %>
        <% user = User.find_by(id: sale_history.user_id) %>
        <%# sale = Sale.find_by(id: sale_history.sale)%>
        <% if status.try(:nama_status) == 'pending review by admin persediaan' %>
        <tr>
        <td><%= sale_history.catatan_penjualan %></td>
          <td class="align-middle text-center"><%= user.try(:name) %></td>
          <td class="align-middle text-center">
            <button class='btn btn-warning font-weight-bolder btn-sm py-1 mb-1 px-2' disabled>
              <%= status.try(:nama_status) %>
            </button></td>
          <td class="align-middle text-center"><%= sale_history.nomor_penjualan %></td>
          <td class="align-middle text-center">
            <%= link_to sale_history,  class:"btn btn-warning btn-sm rounded-circle text-white py-1 mb-1 px-2" do  %>
              <i class="fas fa-eye"></i>
            <% end %>
            <%#= link_to edit_sale_path(sale_history),  class:"btn btn-success btn-sm rounded-circle text-white py-1 mb-1 px-2" do  %>
<!--              <i class="fas fa-pencil-alt"></i>-->
            <%# end %>
          </td>
        </tr>

          <% elsif status.try(:nama_status) == 'pending review by kadep persediaan' %>
          <tr>
            <td><%= sale_history.catatan_penjualan %></td>
            <td class="align-middle text-center"><%= user.try(:name) %></td>
            <td class="align-middle text-center">
              <button class='btn btn-warning font-weight-bolder btn-sm py-1 mb-1 px-2' disabled>
                <%= status.try(:nama_status) %>
              </button></td>
            <td class="align-middle text-center"><%= sale_history.nomor_penjualan %></td>
            <td class="align-middle text-center">
              <%= link_to sale_history,  class:"btn btn-warning btn-sm rounded-circle text-white py-1 mb-1 px-2" do  %>
                <i class="fas fa-eye"></i>
              <% end %>
              <%#= link_to edit_sale_path(sale_history),  class:"btn btn-success btn-sm rounded-circle text-white py-1 mb-1 px-2" do  %>
              <!--              <i class="fas fa-pencil-alt"></i>-->
              <%# end %>
            </td>
          </tr>
        <% elsif status.try(:nama_status) == 'pending review by staff gudang' %>
          <tr>
            <td><%= sale_history.catatan_penjualan %></td>
            <td class="align-middle text-center"><%= user.try(:name) %></td>
            <td class="align-middle text-center">
              <button class='btn btn-warning font-weight-bolder btn-sm py-1 mb-1 px-2' disabled>
                <%= status.try(:nama_status) %>
              </button></td>
            <td class="align-middle text-center"><%= sale_history.nomor_penjualan %></td>
            <td class="align-middle text-center">
              <%= link_to sale_history,  class:"btn btn-warning btn-sm rounded-circle text-white py-1 mb-1 px-2" do  %>
                <i class="fas fa-eye"></i>
              <% end %>
              <%#= link_to edit_sale_path(sale_history),  class:"btn btn-success btn-sm rounded-circle text-white py-1 mb-1 px-2" do  %>
              <!--              <i class="fas fa-pencil-alt"></i>-->
              <%# end %>
            </td>
          </tr>
        <% elsif status.try(:nama_status) == 'pending review by kepala gudang' %>
          <tr>
            <td><%= sale_history.catatan_penjualan %></td>
            <td class="align-middle text-center"><%= user.try(:name) %></td>
            <td class="align-middle text-center">
              <button class='btn btn-warning font-weight-bolder btn-sm py-1 mb-1 px-2' disabled>
                <%= status.try(:nama_status) %>
              </button></td>
            <td class="align-middle text-center"><%= sale_history.nomor_penjualan %></td>
            <td class="align-middle text-center">
              <%= link_to sale_history,  class:"btn btn-warning btn-sm rounded-circle text-white py-1 mb-1 px-2" do  %>
                <i class="fas fa-eye"></i>
              <% end %>
              <%#= link_to edit_sale_path(sale_history),  class:"btn btn-success btn-sm rounded-circle text-white py-1 mb-1 px-2" do  %>
              <!--              <i class="fas fa-pencil-alt"></i>-->
              <%# end %>
            </td>
          </tr>
        <% end %>
      <% end %>
      </tbody>
    </table>
  </div>
</div>

<% end %>
